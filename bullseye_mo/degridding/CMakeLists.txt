project(degrid)

set(CUDA_TOOLKIT_ROOT_DIR /usr/local/cuda)
FIND_PACKAGE(CUDA REQUIRED)
list(APPEND CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake")
find_package(CasaCore REQUIRED COMPONENTS measures scimath tables)
find_package(Boost REQUIRED)
include_directories(/usr/include/casacore/ /usr/local/include/casacore)
set(CMAKE_BUILD_TYPE Release)
set(CMAKE_CXX_FLAGS "-DBULLSEYE_SINGLE -Wall -fno-strict-aliasing -pthread -fopenmp -O3 --std=c++11")
SET(CUDA_NVCC_FLAGS "-DBULLSEYE_SINGLE -O3 -gencode arch=compute_20,code=sm_20 -gencode arch=compute_20,code=sm_21 -gencode arch=compute_30,code=sm_30 --use_fast_math -Xptxas -dlcm=ca -lineinfo")
cuda_add_library(degrid SHARED degrid.cpp)
CUDA_ADD_CUFFT_TO_TARGET(degrid)
target_link_libraries(degrid casa_casa)
